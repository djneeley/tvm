<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->  
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="styles.css">
    <script src="tvm.js"></script>
    
    <title>TVM</title>
  </head>
  <body>
    <div class="container">

    <div class="sticky-top bg-white pb-1">
        <h3>Retirement Income</h3>
        <p class="lead">$<span id="retirementIncome">0</span> per year</p>
    </div>
    

    <div class="row">
        <div class="col-md mb-4">
            <h6>Current Savings</h6>
            <p class="lead">$<span id="currentSavingsLabel">10,000</span></p>
            <div class="slidecontainer">
                <input type="range" id="currentSavings" min="0" max="1000000" step="1000" value="10000" oninput="updateResult()" class="slider">
            </div>
        </div>
        <div class="col-md mb-4">
            <h6>Monthly Savings</h6>
            <p class="lead">$<span id="monthlySavingsLabel">1000</span> per month</p>
            <div class="slidecontainer">
                <input type="range" id="monthlySavings" min="0" max="10000" step="50"  value="1000" oninput="updateResult()" class="slider">
            </div>
        </div>
        <div class="col-md mb-4">
            <h6>Savings Increase</h6>
            <p class="lead"><span id="savingsIncreaseLabel">3</span>% per year</p>
            <div class="slidecontainer">
                <input type="range" id="savingsIncrease" min="0" max="10" step="0.1" value="3" oninput="updateResult()" class="slider">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4 mb-4">
            <h6>Investment Return</h6>
            <p class="lead"><span id="investmentReturnLabel">8</span>% per year</p>
            <div class="slidecontainer">
                <input type="range" id="investmentReturn" min="0" max="12" step="0.1" value="8" oninput="updateResult()" class="slider">
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <h6>Inflation Rate</h6>
            <p class="lead"><span id="inflationRateLabel">3</span>% per year</p>
            <div class="slidecontainer">
                <input type="range" id="inflationRate" min="0" max="5" step="0.1" value="3" oninput="updateResult()" class="slider">
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4 mb-4">
            <h6>Years to Retirement</h6>
            <p class="lead"><span id="yearsToRetirementLabel">30</span> years</p>
            <div class="slidecontainer">
                <input type="range" id="yearsToRetirement" min="0" max="50" step="1" value="30" oninput="updateResult()" class="slider">
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <h6>Years in Retirement</h6>
            <p class="lead"><span id="yearsInRetirementLabel">40</span> years</p>
            <div class="slidecontainer">
                <input type="range" id="yearsInRetirement" min="1" max="50" step="1" value="40" oninput="updateResult()" class="slider">
            </div>
        </div>
    </div>

    <h2>Options</h2>
      <div class="onoffswitch">
        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" checked onchange="updateResult()">
        <label class="onoffswitch-label" for="myonoffswitch">
          <span class="onoffswitch-inner"></span>
          <span class="onoffswitch-switch"></span>
        </label>
      </div>

    </div>

    <script language="javascript" type="text/javascript">
      updateResult();

      function updateResult()
      {
        var currentSavings = document.querySelector('#currentSavings');
        document.querySelector('#currentSavingsLabel').textContent = (Number(currentSavings.value)).formatMoney(0);
        var monthlySavings = document.querySelector('#monthlySavings');
        document.querySelector('#monthlySavingsLabel').textContent = (Number(monthlySavings.value)).formatMoney(0);
        var savingsIncrease = document.querySelector('#savingsIncrease');
        document.querySelector('#savingsIncreaseLabel').textContent = (Number(savingsIncrease.value)).formatMoney(1);
        var investmentReturn = document.querySelector('#investmentReturn');
        document.querySelector('#investmentReturnLabel').textContent = (Number(investmentReturn.value)).formatMoney(1);
        var inflationRate = document.querySelector('#inflationRate');
        document.querySelector('#inflationRateLabel').textContent = (Number(inflationRate.value)).formatMoney(1);
        var yearsToRetirement = document.querySelector('#yearsToRetirement');
        document.querySelector('#yearsToRetirementLabel').textContent = yearsToRetirement.value;
        var yearsInRetirement = document.querySelector('#yearsInRetirement');
        document.querySelector('#yearsInRetirementLabel').textContent = yearsInRetirement.value;
        var monthlyReturn = annualToMonthly(investmentReturn.value/100);
        var monthlySavingsIncrease = annualToMonthly(savingsIncrease.value/100);
        var savingsAtRetirement = PVFutureSum(currentSavings.value, yearsToRetirement.value*12,monthlyReturn) + FVGrowingAnnuity(monthlySavings.value, yearsToRetirement.value*12, monthlyReturn, monthlySavingsIncrease);
        var initialPayment = 0;
        if (document.getElementById('myonoffswitch').checked)
        {
            initialPayment = RIGrowingAnnuity(savingsAtRetirement,yearsInRetirement.value,investmentReturn.value/100,inflationRate.value/100);
        }
        else
        {
        	initialPayment = RIGrowingPerpetuity(savingsAtRetirement, investmentReturn.value/100, inflationRate.value/100);
        }

        var retirementIncome = (Math.round(PVFutureSum(initialPayment, yearsToRetirement.value, inflationRate.value/100)/1000)*1000).formatMoney(0);
        document.querySelector('#retirementIncome').textContent = retirementIncome;
        return True;
      }
    </script>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
      
  </body>
</html>
